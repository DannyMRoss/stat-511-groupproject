\documentclass[11pt]{article} 

\usepackage[margin=1in]{geometry}
\usepackage[onehalfspacing]{setspace}
\usepackage{indentfirst}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{float}
\usepackage{xcolor}
\usepackage{titlesec} 
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[hidelinks]{hyperref}
\usepackage{tocloft} 

\renewcommand{\algorithmiccomment}[1]{// \textit{#1}}

\titleformat{\section}[runin]
  {\normalfont\normalsize\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}[runin]
  {\normalfont\normalsize\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[runin]
  {\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}

\title{\textbf{STAT 511 Group Project}}
\author{Chengyuan $\diamond$ Daniel $\diamond$ Junjie}

\fancyhf{}
\fancyhead[R]{Chengyuan $\diamond$ Daniel $\diamond$ Junjie}
\fancyhead[L]{STAT 511 $\diamond$ Group Project}
\fancyfoot[C]{\thepage}
\setlength{\headheight}{15pt}

\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}

\newcommand{\teh}{treatment effect heterogeneity}
\newcommand{\hte}{heterogeneous treatment effects}

\begin{document}

\begin{titlepage}
  \maketitle
  \tableofcontents
  \listoffigures
  \listoftables
  
  \vspace{1em}
  
  \begin{center}
  	\textbf{\large Author Contributions} 
  \end{center}
  
  \textbf{Chengyuan}: reproducing results, simulation study \textbf{Daniel}: report writing, exploratory data analysis \textbf{Junjie} estimating algorithms.
  
\end{titlepage}

\pagestyle{fancy}

\setcounter{page}{1}
\section{Problem Description and Modeling Objective}
%Provide a clear statement of the problem being investigated in the paper. Clearly state the specific objective of the statistical modeling.

In the paper ``Estimating treatment effect heterogeneity in randomized program evaluation,''\cite{imai_estimating_2013} the authors are concerned with ``treatment effect heterogeneity'' which they define as ``the degree to which different treatments have differential causal effects on each unit.'' 
The authors' objective is to estimate \teh\ in order to (1) select the most effective treatment among a large number of available treatments, (2) design optimal treatments for sub-groups of units, (3) test the existence of \teh, and (4) generalize causal effect estimates from a sample to a target population.

\section{Data Description and Availability of Dataset}
%Provide a detailed overview of the dataset used (from the main application), including information about the variables in the dataset.

The \texttt{R} package \texttt{FindIt} includes the data from two well-known randomized evaluation studies in the social sciences that the authors' apply their model to.\cite{FindIt2012} 
Including the dataset \texttt{GerberGreen}, which is data from the 1998 New Haven Get-Out-the-Vote filed experiment where many different mobilization techniques were randomly administered to voters in the 1998 election.
As well as the dataset \texttt{LaLonde}, which is data from the national supported work (NSW) program that was a job training program intended to increase earnings of workers conducted from 1975 to 1978 over 15 sites in the United States.

\subsection{Gerber and Green (1998) New Haven Get-Out-the-Vote}

The \texttt{GerberGreen} dataset includes one binary outcome variable, four treatment variables, and four pre-treatment control covariates.
Specifically, \texttt{voted98} is the binary outcome variable of whether a registered voter voted or not in the 1998 election.
The appendix includes a preview of \texttt{GerberGreen} at Table~\ref{tab:GerberGreen} as well as additional details on the covariates. 

Of the 14,774 registered voters collected in \texttt{GerberGreen}, 5,879 (39.8\%), voted in the 1998 election.
Figure~\ref{fig:gerbergreentreatments} provides the proportion that voted in the 1998 election by the levels of each of the four treatment types.
Whereas, Figure~\ref{fig:gerbergreencontrols} provides the proportion that voted in the 1998 election by the levels of each of the four pre-treatment controls.

Further, Table~\ref{tab:GerberGreenTreatmentInteraction} provides a breakdown of the proportion of registered voters that voted in 1998 by each of the combinations of the four treatment variables present in \texttt{GerberGreen}.
Finally, Table~\ref{tab:GerberGreenControlInteraction} provides a breakdown of the proportion of registered voters that voted in 1998 by each of the combinations of the pre-treatment control covariates.

These figures demonstrate the heterogeneity in voting outcome by both treatment type and control condition and motivate the need for a model that can detect causal effects in such an environment. 

\subsection{LaLonde (1996) National Supported Work Study}

The \texttt{LaLonde} dataset includes one binary outcome variable, one binary treatment variable, and ten pre-treatment control covariates.
Specifically, \texttt{outcome} is a binary outcome variable of whether earnings in 1978 are larger than in 1975.
The appendix includes a preview of \texttt{LaLonde} at Table~\ref{tab:LaLonde} as well as additional details on the covariates. 

Of the 722 workers in \texttt{LaLonde}, 408 (56.5\%), had larger earnings in 1978 compared to 1975.
Figure~\ref{fig:lalondetreatments} provides the proportion that had larger earnings in the control and treatment groups.
Whereas, Figure~\ref{fig:lalondecontrols} provides the proportion that had larger earnings by the levels of each of the pre-treatment controls.

\section{Model and Methods Description}
%Clearly describe the proposed model in the analysis. Outline the statistical estimation methods. For the proposed inference methods, provide an algorithm (e.g.,  with sufficient detail to implement the methods, using the input described in the Data Description section.

\subsection{Framework}

In order to overcome the methodological challenges of (1) extracting useful information from sparse randomized evaluation study data, (2) identifying sub-groups for whom a treatment is beneficial, and (3) generalizing the results of an experiment to a target population, the authors' formulate the estimation of heterogeneous treatment effects as a variable selection problem.
Specifically, the paper develops a Squared Loss Support Vector Machine (L2-SVM) with separate LASSO constraints over the pre-treatment and causal heterogeneity parameters, such that the causal heterogeneity variables of interest are separated from the rest of the variables. 

The proposed model is grounded within the potential outcomes framework for causal inference.
In this framework, the causal effect of treatment $t$ for unit $i$ is defined as $Y_i(t) - Y_i(0)$, where $Y_i$ is the potential outcome for unit $i$ under treatment or control.
Thus, by leveraging the fact that the L2-SVM is an optimal classifier, the proposed model can estimate \hte\ by predicting the potential outcomes $Y_i(t)$ directly from the fitted model and estimate the conditional treatment effect as the difference between the predicted outcome under treatment status $t$ and under the control condition.

To fit the proposed model the authors' use an estimation algorithm based on a generalized cross-validation (GCV) statistic.
Because of the structure of the proposed model, the SVM becomes a least squares problem on a subset of the data, therefore the L2-SVM is fitted through a series of iterated LASSO fits.
Accordingly, the authors' employ an efficient coordinate descent algorithm for the LASSO fits. 

\subsection{Model}

For modeling, the authors transform the binary outcome to $Y_i^* = 2Y_i - 1 \in \{\pm1\}$ and then relate the estimated binary outcome $\hat{Y_i} \in \{\pm1\}$ to the estimated latent variable $\hat{W_i} \in \mathbb{R}$, where \[\hat{Y_i} = \operatorname{sgn}(\hat{W_i})\quad\text{and}\quad\hat{W_i} = \hat{\mu} + \hat{\beta}^{\top}Z_i + \hat{\gamma}^{\top}V_i,\] here $Z_i$ is an $L_Z$ dimensional vector of treatment effect heterogeneity variables and $V_i$ is an $L_V$ dimensional vector containing the remaining control covariates.
Thus, the causal heterogeneity variables of interest, $Z_i$, are separated from the rest of the variables.

In order to estimate the parameters $(\beta, \gamma)$ the authors adapt a support vector machine (SVM) classifier and place separate LASSO constraints over each set of coefficients. 
Specifically, the estimates are given by the objective function \[(\hat{\beta}, \hat{\gamma}) = \underset{(\beta, \gamma)}{\text{arg min}} \sum_{i=1}^{n} w_i \cdot |1-Y_i^* \cdot(\mu + \beta^{\top}Z_i + \gamma^{\top}V_i)|^2_{+} + \lambda_Z \sum_{j=1}^{L_Z} |\beta_j| + \lambda_V \sum_{j=1}^{L_V}|\gamma_j|,\] where $\lambda_Z$ and $\lambda_V$ are pre-determined separate LASSO penalty parameters and $w_i$ is an optional sampling weight for generalizing results from a sample to a target population.
Here, the authors formulate the SVM as a penalized squared hinge-loss objective function (L2-SVM) where the hinge-loss is defined as $|x|_+ \equiv \max(x,0)$. 

\subsection{Estimating heterogeneous treatment effects}

By leveraging the fact that the L2-SVM is an optimal classifier, the proposed model can estimate \hte\ by predicting the potential outcomes $Y_i(t)$ directly from the fitted model and estimate the conditional treatment effect (CTE) as the difference between the predicted outcome under treatment status $t$ and under the control condition: $\hat{\delta}(t; \tilde{X}_i) = \frac{1}{2}(\hat{Y}_i(t) - \hat{Y}_i(0))$.
Further, the model can estimate the conditional average treatment effect (CATE), which is defined as $\tau(t; \tilde{x}) = \mathbb{E}(Y_i(t) - Y_i(0)\,|\,\tilde{X}_i = \tilde{x})$, for a given covariate profile $\tilde{x}$.
Specifically, the authors define $\hat{W}_i^*(t)$ as the predicted $\hat{W}_i^*(t)$ values truncated at positive and negative one.
Then the CATE is estimated as the difference in truncated values of the predicted outcome variables, $\hat{\tau}(t; \tilde{X}_i) = \frac{1}{2}(\hat{W}_i^*(t) - \hat{W}_i^*(0))$. 
While not a true difference in probabilities, the authors argue that $\hat{\tau}(t; \tilde{X}_i)$ provides a reasonable approximation of the CATE. 

\subsection{Estimating algorithm}

This paper introduces an estimation algorithm for the L2-SVM with separate LASSO penalties on treatment and non-treatment covariates. 
For fixed tuning parameters $(\lambda_Z,\lambda_V)$, the covariates are first rescaled, and the model is then fitted iteratively by focusing on the set of ``active'' observations whose hinge loss is positive. 
At each iteration, the covariates and the transformed outcome are centered within the current active set, the LASSO coefficients are updated using a least squares criterion with $\ell_1$ penalties, and the fitted values and the active set are recomputed. 
This procedure is repeated until the coefficients converge, yielding the final estimates $(\mu,\beta,\gamma)$ and scores $W_i$.

\input{algosvm}

Selection of the tuning parameters $(\lambda_Z,\lambda_V)$ is carried out using a generalized cross-validation (GCV) statistic based on the squared hinge loss over the active set and the effective degrees of freedom (the number of nonzero coefficients). 
Starting from a large value of the penalty on causal heterogeneity covariates, a coarse grid search over $\lambda_V$ is performed and the value that minimizes the GCV criterion is selected.
Given this value, a grid search over $\lambda_Z$ is conducted in the same way. 
These one-dimensional line searches in $\lambda_V$ and $\lambda_Z$ are alternated until convergence, and the search is then refined around the converged values. 
The resulting $(\hat\lambda_Z,\hat\lambda_V)$ are used to
obtain the final L2-SVM fit.

\input{algogcv}
\vspace{-1em}

\section{Reproducing Results}

In this section, we reproduce the main findings from the paper by applying the \texttt{FindIt} method to the two datasets analyzed in the original study: the GerberGreen dataset and the LaLonde dataset. We use the \texttt{FindIt} R package to implement the L2-SVM with double LASSO approach and compare our results with those reported in the paper.

\subsection{GerberGreen Factorial Design}

Following the paper's approach, we apply the \texttt{FindIt} method to the GerberGreen dataset using the factorial design specification. The paper uses a factorial treatment design with four treatment factors: \texttt{persngrp} (personal visit), \texttt{phnscrpt} (phone script), \texttt{mailings} (number of mailings), and \texttt{appeal} (appeal type). We implement this using the \texttt{treat.type = "multiple"} specification with \texttt{nway = 4} to generate all treatment-treatment interactions.

We fit the \texttt{FindIt} model using the exact syntax from the \texttt{FindIt} package documentation (Example 2):
\begin{align}
    \text{model.treat} &: \quad \texttt{voted98} \sim \texttt{persngrp} + \texttt{phnscrpt} + \texttt{mailings} + \texttt{appeal} \\
    \text{model.main} &: \quad \sim \texttt{age} + \texttt{majorpty} + \texttt{vote96.1} + \texttt{vote96.0}
\end{align}
with \texttt{nway = 4} to generate all two-way, three-way, and four-way interactions among the treatment factors. We use the tuning parameters $\lambda_Z = -15.000$ and $\lambda_V = -6.237$ as provided in the \texttt{FindIt} package documentation example.

Our analysis identifies 20 nonzero treatment coefficients, including main effects and interaction terms. The top treatment combination identified by the model is \texttt{persngrp = 1}, \texttt{phnscrpt = 0}, \texttt{mailings = 0}, \texttt{appeal = 3}, with an estimated treatment effect of 0.0326 (3.26 percentage points). This result is consistent with the paper's key finding that personal visits (\texttt{persngrp = 1}) are the most effective mobilization strategy.

The top five treatment combinations all involve personal visits (\texttt{persngrp = 1}) with no phone calls (\texttt{phnscrpt = 0}), confirming the paper's conclusion that canvassing in person is the most effective get-out-the-vote technique. The estimated effects range from 0.0245 to 0.0326 percentage points, which are similar in magnitude to the paper's reported effects (e.g., 2.69 percentage points for personal visits compared to baseline).

The paper reports identifying 15 nonzero treatment effect combinations out of 192 possible combinations. Our analysis identifies 20 nonzero coefficients, which may reflect differences in the exact lambda values used or minor differences in the implementation. However, the qualitative findings are consistent: personal visits are identified as the most effective treatment, and the estimated effects are of similar magnitude to those reported in the paper.

\subsection{LaLonde Treatment-Covariate Interactions}

For the LaLonde dataset, we apply the \texttt{FindIt} method with the single treatment type specification to identify treatment-covariate interactions. The paper uses this dataset to identify subgroups of workers for whom the job training program is beneficial.

We fit the \texttt{FindIt} model with treatment-covariate interactions:
\begin{align}
    \text{model.treat} &: \quad \texttt{outcome} \sim \texttt{treat} \\
    \text{model.main} &: \quad \sim \texttt{age} + \texttt{educ} + \texttt{black} \\
    \text{model.int} &: \quad \sim \texttt{age} + \texttt{educ} + \texttt{black}
\end{align}
where \texttt{treat} is the binary treatment indicator (job training program), and we allow for interactions between treatment and the pre-treatment covariates. We use automatic lambda selection (\texttt{search.lambdas = TRUE}) to choose optimal tuning parameters via generalized cross-validation.

Our analysis yields an average treatment effect (ATE) estimate of 0.0627 (6.27 percentage points), indicating that workers who received the job training were 6.27 percentage points more likely to have increased earnings from 1975 to 1978 compared to those who did not receive the treatment. The model identifies 8 nonzero coefficients, including main effects and treatment-covariate interaction terms.

The optimal tuning parameters selected by the method are $\lambda_Z = -4.9175$ and $\lambda_V = -2.9$. The predicted treatment effects are relatively homogeneous across units (ranging from 0.0627 to 0.0629), suggesting that in this particular sample, the treatment effects do not vary substantially across different covariate profiles.

The paper reports an ATE estimate of 7.61 percentage points for the NSW sample, which is somewhat higher than our estimate of 6.27 percentage points. This difference may be due to several factors: (1) differences in the exact covariate specification (the paper uses 44 covariates including squared terms and interactions, while we use a simplified specification with 3 main covariates); (2) differences in lambda selection; or (3) minor differences in data preprocessing. However, both estimates are positive and of similar magnitude, confirming the paper's finding that the job training program has a positive average effect.

The paper also identifies substantial heterogeneity in treatment effects across subgroups (e.g., CATE as high as 53 percentage points for low education, non-Hispanic, high earning workers, and as low as -21 percentage points for high earning Hispanic workers). Our simplified analysis with fewer covariates may not capture this full heterogeneity, which explains why our predicted effects are more homogeneous.

\subsection{Discussion}

Our reproduction of the paper's results demonstrates both successes and challenges in applying the \texttt{FindIt} method. For the GerberGreen dataset, we successfully reproduce the key qualitative finding that personal visits are the most effective mobilization strategy, using the factorial design approach that matches the paper's methodology. The estimated treatment effects are of similar magnitude to those reported in the paper, confirming the robustness of this finding.

For the LaLonde dataset, we obtain an ATE estimate that is qualitatively consistent with the paper's findings (positive effect of job training), though quantitatively somewhat smaller. The difference likely reflects our use of a simplified covariate specification compared to the paper's more comprehensive model with 44 covariates. This highlights the importance of covariate selection in identifying treatment effect heterogeneity.

Overall, our reproduction confirms that the \texttt{FindIt} method can successfully identify treatment effects and treatment-covariate interactions in real-world datasets. The method's performance depends on appropriate specification of the treatment structure (factorial design for multiple treatments, single treatment with interactions for heterogeneous effects) and careful selection of tuning parameters.

\section{Results}

\subsection{Selecting the best get-out-the-vote mobilization strategies}

To fit their proposed model to the \texttt{GerberGreen} data, the authors transform \texttt{voted98} to $\{\pm1\}$, define $Z_i$ as 192 binary indicator variables for the 192 possible treatment combinations, such that $K_Z = 192$, and define $V_i$ as the pre-treatment control covariates including the four main effects of \texttt{age}, \texttt{majorpty}, \texttt{vote96.1}, \texttt{vote96.0}; five two-way interaction terms: \texttt{age}:\texttt{majorpty}, \texttt{age}:\texttt{vote96.1}, \texttt{age}:\texttt{vote96.0}, \texttt{majorpty}:\texttt{vote96.1}, and \texttt{vote96.1}:\texttt{vote96.0}; and \texttt{age}$^2$, such that $K_V = 10$.

The authors find that 15 of the 192 treatment effect combinations are estimated as nonzero. 
Notably, they find that canvassing in person, i.e., \texttt{persngrp} $=1$, is the most effective GOTV technique.
Specifically, they find that compared to the baseline of no treatment of any type administered, registered voters that received a personal visit were 2.69 percentage points more likely to vote.
Further, they find that all mobilization strategies with a phone call and no personal visit either have no effect on voter turnout or are estimated to decrease voter turnout.
For example, they find that the mobilization strategy of (\texttt{persngrp} $=0$, \texttt{phnscrpt} $=2-$civic appeal, \texttt{mailings} $=3$, \texttt{appeal} $=2-$ neighborhood solidarity) was estimated to decrease voter turnout by 4.12 percentage points compared to the baseline.
Moreover, they find that the most effective treatment combination without canvassing was three mailings with a civic responsibility message and no phone calls, which was estimated to increase voter turnout by 1.17 percentage points.
This result is relevant because canvassing is the most expensive mobilization strategy.

Therefore, the authors conclude that in the presence of canvassing, the additional treatments of phone calls or mailings will lessen the canvassing's effectiveness. And if voters are not canvassed, they should be treated with three mailings with a civi duty appeal. 

\subsection{Identifying workers for whom job training is beneficial}

In the application of their model to the \texttt{LaLonde} dataset, the authors (1) identify groups of workers for whom the training program is beneficial, and (2) generalize the results based on this experiment to a target population, where the target population is a 1978 panel study of income dynamics (PSID) that oversamples low-income individuals.

 To fit their proposed model to the \texttt{LaLonde} data, the authors transform \texttt{outcome} to $\{\pm1\}$.
 Then they define the pre-treatment control covariates $V$ as as the 12 main effects of \texttt{age}, \texttt{age}$^2$, \texttt{educ}, \texttt{educ}$^2$, \texttt{log.re75}, \texttt{log.re75}$^2$, \texttt{black}, \texttt{hisp}, \texttt{white}, \texttt{marr}, \texttt{nodegr}, and \texttt{u75}; and 32 two-way interaction terms between the pre-treatment control covariates\footnote{The race indicators are not interacted with each other.}. Such that $K_V = 44$. 
The causal heterogeneity variables $Z$ include the binary treatment \texttt{treat} and the 44 interaction terms between \texttt{treat} and the pre-treatment controls. Thus, $K_Z = 45$.

Overall, the model produces an ATE estimate of 7.61 percentage points for the NSW sample, meaning that workers that received the job training were 7.61 percentage points more likely to have their earnings increase from 1975 to 1978 than those who did not receive the treatment.
Crucially, the model is able to identify groups of workers for whom the training program is helpful/harmful.
Specifically, the model finds that the CATE for groups of low education, non-Hispanic, high earning workers was as high as 53 percentage points.
However, the CATE for groups of high earning Hispanic workers was as low as -21 percentage points.

\section{Conclusion}

This project has successfully reproduced the methods from Imai and Ratkovic (2013) for estimating treatment effect heterogeneity in randomized program evaluation. Through our analysis of the GerberGreen and LaLonde datasets using the \texttt{FindIt} R package, we have demonstrated the practical application of the L2-SVM with double LASSO approach for identifying heterogeneous treatment effects.

Our key findings from reproducing the paper's results include: (1) the successful implementation of the factorial design analysis for the GerberGreen dataset, which confirms that personal visits are the most effective mobilization strategy, with estimated effects (ranging from 2.45 to 3.26 percentage points) consistent with the paper's findings (2.69 percentage points); (2) the reproduction of the LaLonde analysis, obtaining an ATE estimate of 6.27 percentage points that is qualitatively consistent with the paper's estimate of 7.61 percentage points, demonstrating the robustness of the method's findings despite differences in covariate specification; and (3) the identification of 20 nonzero treatment coefficients in GerberGreen and 8 nonzero coefficients in LaLonde, showing that the method successfully identifies treatment effects and interactions in real-world datasets.

The reproduction results demonstrate that the \texttt{FindIt} method successfully identifies treatment effects in real-world datasets when appropriately specified. The factorial design approach with \texttt{treat.type = "multiple"} works well for the GerberGreen dataset with multiple treatment factors, generating all treatment-treatment interactions and identifying the most effective treatment combinations. The single treatment type with interactions approach captures average treatment effects in the LaLonde dataset, though our simplified covariate specification (3 covariates versus the paper's 44 covariates) may not capture the full heterogeneity identified in the original study. This highlights the importance of comprehensive covariate selection in identifying treatment effect heterogeneity.

As a supplementary analysis, we also conducted a simulation study with homogeneous treatment effects (presented in the Appendix), which reveals that the method's performance depends critically on matching the specification to the data structure. This finding emphasizes the importance of understanding the underlying assumptions of the method and choosing appropriate specifications based on the data characteristics.

Future research directions include: exploring more comprehensive covariate specifications to better capture treatment effect heterogeneity, investigating the sensitivity of results to lambda selection methods, comparing performance across different datasets and application domains, and developing guidelines for choosing appropriate \texttt{FindIt} specifications based on data characteristics.

% Bibliography ----------------------
\newpage
\bibliographystyle{plain}
\bibliography{../bibliography}

\newpage
\appendix
\renewcommand{\thetable}{A\arabic{table}}
\renewcommand{\thefigure}{A\arabic{figure}}
\section{Appendix} \hfill\newline

\subsection{Exploratory Data Analysis}

Table~\ref{tab:GerberGreen} provides a preview of the \texttt{GerberGreen} dataset.
\texttt{voted98} is a binary outcome variable of whether a registered voter voted or not in the 1998 election;
\texttt{persngrp} is a binary treatment variable of whether a personal visit of a registered voter was made;
\texttt{phnscrpt} is a categorical treatment variable with 7 levels (0 - no phone call, 1 - donate blood, 2 - civic appeal, 3 - civic appeal/donate blood, 4 - neighborhood solidarity, 5 - civic appeal/neighborhood solidarity, 6 - close election), for the phone message scripts read to registered voters;
\texttt{mailings} is an ordinal treatment variable of the number (0-3) of mailings sent to voters;
\texttt{appeal} is a categorical treatment variable with 3 levels (1 - civic duty, 2 - neighborhood solidarity, 3 - close election) for the content of the appeal made to registered voters;
\texttt{age} is an ordinal control for the age of the registered voter;
\texttt{majorpty} is a binary control for whether the registered voter was registered with either the Democratic or Republican part (1) or not (0);
\texttt{vote96.1} is a binary control for whether the registered voter voted in the 1996 election; and
\texttt{vote96.0} is a binary control for whether the registered voter abstained in the 1996 election.

\input{tbls/GerberGreentbl.tex}

Table~\ref{tab:GerberGreenTreatmentInteraction} below provides a breakdown of the proportion of registered voters that voted in 1998 by each of the combinations of the four treatment variables present in \texttt{GerberGreen}. Note, in the original experiment design there were 193 unique treatment combinations randomly administered to registered voters; however, the authors limited their study to single voter households to avoid interference among voters in the same household and thus only 72 treatment combinations are present in the subsetted data.
Figure~\ref{fig:gerbergreentreatments} provides the proportion that voted in the 1998 election by the levels of each of the four treatment types.
Whereas, Figure~\ref{fig:gerbergreencontrols} provides the proportion that voted in the 1998 election by the levels of each of the four pre-treatment controls.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{figs/GerberGreenTreatments.png}
    \caption{Voting Outcome by Treatment Type}
    \label{fig:gerbergreentreatments}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{figs/GerberGreenControls.png}
    \caption{Voting Outcome by Pre-Treatment Control}
    \label{fig:gerbergreencontrols}
\end{figure}

\input{tbls/GerberGreenTreatmentInteraction.tex}

\newpage
Table~\ref{tab:GerberGreenControlInteraction} below provides a breakdown of the proportion of registered voters that voted in 1998 by each of the combinations of the pre-treatment control covariates.

\input{tbls/GerberGreenControlInteraction.tex}

\newpage

Table~\ref{tab:LaLonde} provides a preview of the \texttt{LaLonde} dataset.
This dataset includes one binary outcome variable, one binary treatment variable, and ten pre-treatment control covariates.
Specifically, \texttt{outcome} is a binary outcome variable of whether earnings in 1978 are larger than in 1975;
\texttt{treat} is a binary treatment variable for whether an individual received the job training or not;
\texttt{age} is an ordinal control for the age in years of workers;
\texttt{educ} is an ordinal control for the years of education of workers;
\texttt{black} is a binary control for whether the worker is black or not;
\texttt{hisp} is a binary control for whether the worker is Hispanic or not;
\texttt{white} is a binary control for whether the worker is white or not;
\texttt{marr} is a binary control for whether the worker is married or not;
\texttt{nodegr} is a binary control for whether the worker has a high school degree or not;
\texttt{log.re75} is a continuous control for workers pre-treatment log earnings in 1975;
\texttt{u75} is a binary control for whether the worker was unemployed in 1975 or not.
%\texttt{wts.extrap}

\input{tbls/LaLondetbl.tex}

Figure~\ref{fig:lalondetreatments} provides the proportion that had larger earnings in the control and treatment groups.
Whereas, Figure~\ref{fig:lalondecontrols} provides the proportion that had larger earnings by the levels of each of the pre-treatment controls.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{figs/LaLondeTreatments.png}
    \caption{Earnings Outcome by Treatment}
    \label{fig:lalondetreatments}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{figs/LaLondeControls.png}
    \caption{Earnings Outcome by Pre-Treatment Control}
    \label{fig:lalondecontrols}
\end{figure}

\subsection{Homogeneous Treatment Effects Simulation Study}

In this appendix, we present a simulation study that evaluates the \texttt{FindIt} method's performance when applied to scenarios with homogeneous treatment effects. This study complements the main reproduction results by examining the method's behavior under conditions that differ from its primary design assumptions.

\subsubsection{Simulation Setup}

We design a simplified simulation study based on the paper's setup for identifying best treatments from multiple alternatives. Our simulation parameters are chosen to be computationally feasible while maintaining the key features of the original study.

\paragraph{Data Generating Process}

We generate simulated data with the following characteristics:
\begin{itemize}
    \item \textbf{Number of treatments}: $K = 10$ active treatments plus one control group (treatment 0), for a total of 11 treatment levels.
    \item \textbf{Number of covariates}: $L_V = 3$ pre-treatment covariates, each generated from a standard normal distribution: $V_i \sim \mathcal{N}(0, 1)$.
    \item \textbf{Sample sizes}: We consider three sample sizes: $n \in \{500, 1000, 2000\}$.
    \item \textbf{Replications}: For each sample size, we conduct $R = 100$ independent replications.
\end{itemize}

The true treatment effects are specified as follows:
\begin{itemize}
    \item Treatment 1: $\beta_1 = 0.07$ (largest positive effect, 7 percentage points)
    \item Treatment 2: $\beta_2 = 0.05$ (second largest positive effect, 5 percentage points)
    \item Treatment 3: $\beta_3 = -0.03$ (largest negative effect, -3 percentage points)
    \item Treatments 4--10: $\beta_j \sim \text{Uniform}(-0.01, 0.01)$ (negligible effects, approximately $\pm 1$ percentage point)
\end{itemize}

The covariate effects are set to $\gamma = (0.5, -0.3, 0.3)^\top$, representing substantial predictive power of the pre-treatment covariates.

The data generating process follows a linear probability model:
\begin{align}
    \text{linear predictor} &= \mu + Z_i^\top \beta + V_i^\top \gamma \\
    P(Y_i = 1) &= \Phi(\text{linear predictor})
\end{align}
where $\mu = 0.4$ is the baseline intercept, $Z_i$ is a vector of treatment indicators, $V_i$ is the vector of covariates, and $\Phi(\cdot)$ is the standard normal cumulative distribution function. The binary outcome $Y_i$ is then generated as $Y_i \sim \text{Bernoulli}(P(Y_i = 1))$.

Treatment assignment is random and independent of covariates: each unit is randomly assigned to one of the 11 treatment levels (0--10) with equal probability.

\paragraph{Model Fitting}

For each simulated dataset, we fit the \texttt{FindIt} model using the \texttt{FindIt} package in R. Due to computational constraints and the structure of our simulation (multiple binary treatment indicators rather than factorial treatment factors), we use the single treatment type specification:
\begin{align}
    \text{model.treat} &: \quad Y \sim \text{treatment} \\
    \text{model.main} &: \quad \sim V_1 + V_2 + V_3 \\
    \text{model.int} &: \quad \sim V_1 + V_2 + V_3
\end{align}
where treatment is coded as a multi-valued factor (0--10), and we allow for treatment-covariate interactions.

We use automatic lambda selection (\texttt{search.lambdas = TRUE}) to allow the method to choose optimal tuning parameters via generalized cross-validation (GCV) for each replication.

\paragraph{Evaluation Metrics}

Following the paper's evaluation framework, we assess the method's performance using two metrics:

\begin{enumerate}
    \item \textbf{Discovery Rate (DR)}: The proportion of replications in which the method correctly identifies the treatment with the largest effect (or the top 3 treatments with the largest effects) with the correct sign.
    \item \textbf{False Discovery Rate (FDR)}: The proportion of replications in which the method fails to correctly identify the largest effect (or top 3 effects) but still reports at least one nonzero treatment coefficient.
\end{enumerate}

Specifically, for each replication $r$:
\begin{itemize}
    \item \textbf{DR(largest)}: Indicator that the estimated largest effect (among nonzero coefficients) matches the true largest effect (treatment 1) with correct sign.
    \item \textbf{DR(top 3)}: Indicator that at least 2 of the top 3 estimated effects match the true top 3 effects (treatments 1, 2, 3) with correct signs.
    \item \textbf{FDR(largest)}: $1 - \text{DR(largest)}$ when at least one treatment coefficient is nonzero.
    \item \textbf{FDR(top 3)}: $1 - \text{DR(top 3)}$ when at least one treatment coefficient is nonzero.
\end{itemize}

\subsubsection{Simulation Results}

Table~\ref{tab:simulation_results} presents the simulation results across the three sample sizes. The results show that the \texttt{FindIt} method achieves low discovery rates across all sample sizes, with DR(largest) ranging from 0.01 to 0.02 and DR(top 3) ranging from 0.01 to 0.02.

\begin{table}[H]
\centering
\caption{Simulation Results: Discovery Rate (DR) and False Discovery Rate (FDR)}
\label{tab:simulation_results}
\begin{tabular}{lcccc}
\toprule
Sample Size & DR(largest) & FDR(largest) & DR(top 3) & FDR(top 3) \\
\midrule
$n = 500$   & 0.010 & 0.958 & 0.020 & 0.917 \\
$n = 1000$  & 0.010 & 0.955 & 0.020 & 0.909 \\
$n = 2000$  & 0.020 & 0.926 & 0.010 & 0.963 \\
\bottomrule
\end{tabular}
\end{table}

The results indicate that the method struggles to correctly identify the largest treatment effects in this simulation setup. The discovery rates are consistently low (around 1--2\%) across all sample sizes, suggesting that the method is not effectively distinguishing between treatments with substantial effects and those with negligible effects.

\subsubsection{Discussion and Limitations}

The low discovery rates observed in our simulation study can be attributed to several factors:

\paragraph{Methodological Limitations}

First, the \texttt{FindIt} method with \texttt{treat.type = "single"} is designed to identify \emph{heterogeneous} treatment effects---that is, treatment effects that vary across different covariate profiles. However, our simulation setup assumes \emph{homogeneous} treatment effects---each treatment has a fixed effect that does not depend on covariates. This mismatch between the method's assumptions and the simulation's data generating process may explain the poor performance.

Specifically, the single treatment type specification models treatment effects through treatment-covariate interactions:
\begin{align}
    W_i = \mu + \beta_0 \cdot \text{treatment}_i + \sum_{j=1}^{L_V} \beta_j \cdot (\text{treatment}_i \times V_{ij}) + \sum_{j=1}^{L_V} \gamma_j V_{ij}
\end{align}
where the main treatment effect $\beta_0$ may be shrunk to zero by the LASSO penalty, leaving only interaction terms. In our simulation, where treatment effects are homogeneous (do not depend on covariates), these interaction terms may not capture the true treatment effects effectively.

\paragraph{Computational Constraints}

Second, our simulation uses a simplified setup compared to the paper's original study. The paper's simulation (Section 4.1) uses 49 treatments and more complex data generating processes. Our simplified version with 10 treatments may not fully capture the method's performance characteristics.

Additionally, we use automatic lambda selection for each replication, which is computationally intensive. While this ensures optimal tuning parameters for each dataset, it may also introduce variability in the results across replications.

\paragraph{Evaluation Challenges}

Third, extracting treatment-specific effects from the \texttt{FindIt} output with \texttt{treat.type = "single"} is challenging. The method's \texttt{predict()} function returns conditional treatment effects that depend on each unit's covariate values. We average these effects across units within each treatment group to obtain treatment-level effects, but this averaging may not accurately reflect the true homogeneous effects in our simulation.

\paragraph{Comparison with Paper}

The paper's simulation results (Figure 1) show that the method achieves higher discovery rates, particularly for larger sample sizes. However, the paper's simulation uses a factorial treatment design with \texttt{treat.type = "multiple"}, which is better suited for identifying treatment-treatment interactions and main effects. Our simulation's use of single treatment type may explain the discrepancy in performance.

\subsubsection{Conclusion}

Our simulation study demonstrates the challenges of applying the \texttt{FindIt} method to scenarios with homogeneous treatment effects when using the single treatment type specification. While the method is designed for heterogeneous effects, our simulation shows that it struggles to identify treatments with homogeneous but substantial effects.

These results highlight the importance of matching the method's assumptions to the data structure. For scenarios with homogeneous treatment effects, alternative methods or different \texttt{FindIt} specifications (such as multiple treatment type with factorial designs) may be more appropriate.

Future work could explore:
\begin{itemize}
    \item Using \texttt{treat.type = "multiple"} with factorial treatment designs to better match the paper's approach.
    \item Adjusting the evaluation metrics to account for the method's focus on heterogeneous effects.
    \item Comparing performance across different simulation setups to better understand the method's strengths and limitations.
\end{itemize}

\end{document}

